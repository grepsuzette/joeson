package joeson

// making sure code from README.md once compiled

import (
	"testing"

	j "github.com/grepsuzette/joeson"
)

// named() creates a rule with a name
func named(name string, v any) j.NamedRule { return j.Named(name, v) }

// to make i and o rules
func i(a ...any) j.ILine { return j.I(a...) }
func o(a ...any) j.OLine { return j.O(a...) }

func TestReadmeCreatingSimpleGrammar(t *testing.T) {
	gm := j.GrammarFromLines("my grammar", []j.Line{
		o(named("INPUT", `'hi' _ NAME`)),
		i(named("_", `' '*`)),
		i(named("NAME", `[a-zA-Z]*`), func(it j.Ast) j.Ast {
			return it.(*j.NativeArray).NativeString()
		}),
	})
	if j.IsParseError(gm.ParseString("hi amigo")) {
		t.Fail()
	}
	if !j.IsParseError(gm.ParseString("bye bye")) {
		t.Fail()
	}
}
